# ğŸ›’ Tonar E-Commerce Backend API

A scalable, secure, and production-ready **Node.js backend** for an e-commerce platform, built with **Clean Architecture**, **JWT + Cookie-based Authentication**, and **role-based access control**.

This backend is designed so that:
- Only **Admins** can manage products
- Users can manage profiles, addresses, carts, orders, etc.
- Schemas are published and reused via **npm package**

---

## ğŸš€ Deployment Render

- https://tonarapi-s.onrender.com

## ğŸ“„ API Documentation

- [POSTMAN](https://documenter.getpostman.com/view/48027804/2sBXVZpF9L)

## ğŸ§± Tech Stack

- **Node.js**
- **Express.js**
- **MongoDB + Mongoose**
- **JWT Authentication**
- **Cookie-based sessions**
- **Awilix (Dependency Injection)**
- **bcrypt**
- **Validator**
- **Cloudinary (for product images â€“ optional)**
- **Clean Architecture**

## ğŸš€ Installation & Setup

```
git clone https://github.com/ashu2764/TonarApi-s
cd tonarapi's

npm install

npm run dev
```

## âš™ï¸ Environment Variables
Create a .env file in the root directory:
```
PORT=5000
NODE_ENV=development

MongoDB = MONGODB_URI=mongodb://localhost:27017/tonar_db

JWT_SECRET=your_jwt_secret_key_here
JWT_EXPIRES_IN=7d

CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password

CLIENT_URL=http://localhost:3000

```

---

## ğŸ“‚ Project Architecture
src/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ auth/          # Authentication module
â”‚   â”œâ”€â”€ user/          # User management
â”‚   â”œâ”€â”€ address/       # Address management
â”‚   â”œâ”€â”€ product/       # Product management
â”‚   â”œâ”€â”€ category/      # Category management (planned)
â”‚   â”œâ”€â”€ cart/          # Shopping cart (planned)
â”‚   â”œâ”€â”€ wishlist/      # Wishlist (planned)
â”‚   â”œâ”€â”€ order/         # Order management (planned)
â”‚   â””â”€â”€ payment/       # Payment processing (planned)
â”œâ”€â”€ infrastructure/
â”‚   â”œâ”€â”€ middlewares/   # Custom middlewares
â”‚    â”œâ”€â”€ db/            # DB connection
â”‚    â”œâ”€â”€ email/         # email service for reset password otp
â”‚   â”œâ”€â”€ error-handling/# Error handling utilities
â”‚   â””â”€â”€ cloudinary/    # Cloudinary integration        
â”œâ”€â”€ app.js             # Express app setup
â””â”€â”€ server.js          # Server entry point


### Each module follows: routes â†’ controller â†’ usecase â†’ repository


---

## ğŸ—„ï¸ Database Schemas

### Database schemas are published as a separate npm package:
- User Schema
- Address Schema
- Product Schema

`` npm install @ashu2764/tonar-db-schema ``

`` import { UserSchema, AddressSchema, ProductSchema } from "@ashu2764/tonar-db-schema";``

## âœ… COMPLETED FEATURES

### ğŸ” Authentication APIs

```
POST /api/auth/register
POST /api/auth/login
POST /api/auth/logout
POST /api/auth/forgot-password (OTP based)
POST /api/auth/reset-password
```


âœ” Cookie-based authentication  
âœ” Password hashing with bcrypt  
âœ” OTP-based reset password  
âœ” Secure error handling  

---

### ğŸ‘¤ User APIs

```
GET /api/user/profile
PUT /api/user/profile
PUT /api/user/change-password
DELETE /api/user/delete-account
```


âœ” Authenticated access  
âœ” Password verification  
âœ” Account deletion clears session  

---

### ğŸ“ Address APIs
```
POST /api/address
GET /api/address
PUT /api/address/:id
DELETE /api/address/:id
```


âœ” User-specific addresses  
âœ” Ownership validation  
âœ” Secure update & delete  
âœ” Address schema published separately  

---

### ğŸ“¦ Product APIs (Admin Only)

```
POST /api/product (Admin)
GET /api/products
GET /api/product/:id
PUT /api/product/:id (Admin)
DELETE /api/product/:id (Admin)
```


âœ” Role-based access control  
âœ” Admin-only CRUD  
âœ” Product image support via Cloudinary  
âœ” Clean separation of concerns  

---

ğŸ–¼ï¸ Image Handling

Images are stored in Cloudinary
Only image URLs are stored in MongoDB
Supports multiple product images
Ready for production CDN usage

ğŸ”’ Security Features

HTTP-only cookies
JWT authentication
Role-based middleware
Ownership checks (user â†” address)
Centralized error handling

## ğŸš§ NEXT STEPS (PLANNED)

### ğŸ·ï¸ Category Module
```
POST /api/category          (Admin)
GET  /api/categories
PUT  /api/category/:id      (Admin)
DELETE /api/category/:id    (Admin)
```
### ğŸ›’ Cart Module
```
POST /api/cart/add
GET  /api/cart
PUT  /api/cart/update
DELETE /api/cart/remove/:productId
```
### â¤ï¸ Wishlist Module

```
POST /api/wishlist/add
GET  /api/wishlist
DELETE /api/wishlist/remove/:productId
```
### ğŸ“¦ Order Module

```
POST /api/order
GET  /api/orders
GET  /api/order/:id
PUT  /api/order/cancel/:id
```

### ğŸ’³ Payment Module

```
POST /api/payment/create
POST /api/payment/verify
GET  /api/payment/status/:orderId
```
``(Razorpay / Stripe integration planned)``
### ğŸ“Š Admin Dashboard APIs

```
GET /api/admin/users
GET /api/admin/products
GET /api/admin/orders
PUT /api/admin/order-status/:id
```


## Authors

- [@ashu2764](https://github.com/ashu2764)

